Mostly pseudocode that doesn't build, some functions and data decompiled
